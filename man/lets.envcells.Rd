% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lets_envcells.R
\name{lets.envcells}
\alias{lets.envcells}
\title{Environmental descriptors for Presence–Absence in environmental space}
\usage{
lets.envcells(x, perc = 0.2, remove.cells = FALSE)
}
\arguments{
\item{x}{A list returned by \code{\link{lets.envpam}} containing at least:
\itemize{
  \item \code{$Presence_and_Absence_Matrix_env}: data.frame with columns
        \code{cell_id_env}, the environmental coordinates (e.g., two variables),
        and species presences (one column per species).
  \item \code{$Presence_and_Absence_Matrix_geo}: data.frame with columns
        \code{cell_id_geo}, geographic coordinates (lon, lat), and species presences.
  \item \code{$Env_Richness_Raster}: a \pkg{terra} SpatRaster of richness in environmental space.
}}

\item{perc}{Numeric in (0,1], the fraction used in the robust border metric
(mean of the \emph{n} smallest distances to zero-richness cells). Default = 0.2.}

\item{remove.cells}{Logical. If 'TRUE', remove empty cells from the results.}
}
\value{
A data frame with one row per environmental cell and the following columns:
\itemize{
  \item \code{Cell_env}: Environmental cell identifier.
  \item \code{Frequency}: Number of geographic cells mapped to the environmental cell.
  \item \code{Isolation (Min.)}, \code{Isolation (1st Qu.)}, \code{Isolation (Median)},
        \code{Isolation (Mean)}, \code{Isolation (3rd Qu.)}, \code{Isolation (Max.)}:
        Summary of pairwise geographic distances.
  \item \code{Weighted Mean Distance to midpoint}, \code{Mean Distance to midpoint}:
        Negated distances in standardized environmental space (larger values = more central).
  \item \code{Minimum Zero Distance}, \code{Minimum 10\% Zero Distance}, \code{Distance to MCP border}:
        Three proxies for border proximity.
  \item \code{Frequency Weighted Distance}: Frequency-weighted mean distance to all other env cells.
}
}
\description{
Computes a suite of descriptors for each environmental cell in an
\emph{environmental} presence–absence matrix (envPAM), including:
(i) frequency in geographic space, (ii) geographic isolation statistics
(summary of pairwise distances among geographic cells mapped to the same
environmental cell), (iii) distance to environmental midpoints (mean and
frequency-weighted mean), (iv) distance to environmental “border” (zero-richness
frontier via three proxies), and (v) an environmental isolation metric based on
frequency-weighted Euclidean distance in standardized environmental space.

Distances to midpoints are returned **negated** (i.e., larger values imply
greater centrality in environmental space), following the current implementation.
}
\details{
Summarize environmental–geographical metrics from an envPAM object


Environmental variables (assumed to be the 2nd and 3rd columns of
\code{$Presence_and_Absence_Matrix_env}) are z-scored before computing distances.
Geographic isolation is summarized with \code{summary()} of pairwise distances
among geographic cells that collapse to the same environmental cell.
}
\section{Caveats}{

(1) The code assumes the first column of \code{$Presence_and_Absence_Matrix_env}
indexes environmental cells and columns 2–3 are the two environmental variables.
(2) The geographic matrix assumes lon/lat at columns 3–4. Adjust indices if needed.
(3) If there are no zero-richness cells or < 3 occupied env cells, border metrics
are returned as \code{NA}.
}

\examples{
\dontrun{
data("Phyllomedusa"); data("prec"); data("temp")
prec <- unwrap(prec); temp <- unwrap(temp)
PAM  <- lets.presab(Phyllomedusa, remove.cells = FALSE)
envs <- lets.addvar(PAM, c(temp, prec), onlyvar = TRUE)
colnames(envs) <- c("Temperature", "Precipitation")
wrld_simpl <- get(utils::data("wrld_simpl", package = "letsR"))
PAM <- lets.pamcrop(PAM, terra::vect(wrld_simpl))
res <- lets.envpam(PAM, envs, n_bins = 30)
out <- lets.envcells(res, perc = 0.2)
lets.plot.envcells(res, out)
}

}
\seealso{
\code{\link{lets.envpam}}, \code{\link{lets.plot.envcells}}, \code{\link{lets.plot.envpam}}
}
