<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="letsR">
<title>A guide to transform species distributions into a presence absence matrix based on a user-defined grid in R • letsR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A guide to transform species distributions into a presence absence matrix based on a user-defined grid in R">
<meta property="og:description" content="letsR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">letsR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">5.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/A-guide-to-transform-species-distributions-into-a-presence-absence-matrix-based.html">A guide to transform species distributions into a presence absence matrix based on a user-defined grid in R</a>
    <a class="dropdown-item" href="../articles/Adding-variables-to-a-presenceabsence-object.html">Adding variables to a PresenceAbsence object</a>
    <a class="dropdown-item" href="../articles/cropping-and-subseting-your-presence-absence-matrix.html">Cropping and subseting your presence absence matrix</a>
    <a class="dropdown-item" href="../articles/mapping-species-traits.html">Mapping species traits: community level analysis</a>
    <a class="dropdown-item" href="../articles/species-level-macroecological-analysis.html">Macroecological analysis at the species level</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/macroecology/letsR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>A guide to transform species distributions into a presence absence matrix based on a user-defined grid in R</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/macroecology/letsR/blob/HEAD/vignettes/A-guide-to-transform-species-distributions-into-a-presence-absence-matrix-based.Rmd" class="external-link"><code>vignettes/A-guide-to-transform-species-distributions-into-a-presence-absence-matrix-based.Rmd</code></a></small>
      <div class="d-none name"><code>A-guide-to-transform-species-distributions-into-a-presence-absence-matrix-based.Rmd</code></div>
    </div>

    
    
<p>Species distributions are readily available in online databases, such
as the distribution ranges provided by IUCN or occurrence records found
in GBIF. However, analyzing this type of data often requires
transforming the spatial distribution of species into a presence-absence
matrix or a grid format. In this tutorial, we will guide you through a
straightforward process using the R package <a href="http://onlinelibrary.wiley.com/doi/10.1111/2041-210X.12401/abstract" class="external-link"><code>letsR</code></a>,
authored by <a href="http://bvilela.weebly.com" class="external-link">Bruno Vilela</a> and <a href="http://fabro.github.io" class="external-link">Fabricio Villalobos</a>.</p>
<div class="section level2">
<h2 id="iucn-shapefiles">IUCN shapefiles<a class="anchor" aria-label="anchor" href="#iucn-shapefiles"></a>
</h2>
<p>To begin, download the species distribution shapefiles from the IUCN
<a href="http://www.iucnredlist.org/technical-documents/spatial-data" class="external-link">website</a>.
You can import this data using the <code><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">terra::vect</a></code> or
<code><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">sf::st_read</a></code> functions. For the purpose of this tutorial, I
will be utilizing the distribution data for frogs belonging to the
Phyllomedusa genus, which is conveniently pre-loaded within the
<code>letsR</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.12401" class="external-link">letsR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Phyllomedusa"</span><span class="op">)</span></span></code></pre></div>
<p>We can plot the data to see how it looks like.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot</span></span>
<span><span class="co">## Color settings and assignment</span></span>
<span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Phyllomedusa</span><span class="op">$</span><span class="va">binomial</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">position</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">Phyllomedusa</span><span class="op">$</span><span class="va">binomial</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/pkg/terra/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Phyllomedusa</span><span class="op">$</span><span class="va">binomial</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="va">colors</span><span class="op">[</span><span class="va">position</span><span class="op">]</span></span>
<span><span class="co">## Plot call</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">Phyllomedusa</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">colors</span>, lty <span class="op">=</span> <span class="fl">0</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Spatial polygons of Phyllomedusa"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"wrld_simpl"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">wrld_simpl</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="A-guide-to-transform-species-distributions-into-a-presence-absence-matrix-based_files/figure-html/unnamed-chunk-2-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h3>
<p>Next step, we can use the function <code>lets.presab</code> to
convert species’ ranges (in shapefile format) into a presence-absence
matrix based on a user-defined grid system. A simple way to do this is
to define the extent and resolution of the grid.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PAM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lets.presab.html">lets.presab</a></span><span class="op">(</span><span class="va">Phyllomedusa</span>, xmn <span class="op">=</span> <span class="op">-</span><span class="fl">93</span>, xmx <span class="op">=</span> <span class="op">-</span><span class="fl">29</span>,</span>
<span>                   ymn <span class="op">=</span> <span class="op">-</span><span class="fl">57</span>, ymx <span class="op">=</span> <span class="fl">15</span>, res <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Please be aware that when working with shapefiles containing numerous
species or opting for a high-resolution grid, the function’s execution
may become notably slow. In such instances, it is advisable to monitor
the relative running time of the analysis by enabling the
<code>count = TRUE</code> argument.</p>
<p>The <code>lets.presab</code> function yields a
<code>PresenceAbsence</code> object (unless
<code>show.matrix = TRUE</code>, in which case only a presence-absence
matrix is returned). This object is essentially a list comprising a
presence-absence matrix, a raster containing geographical information,
and the species names. For additional details, refer to
<code><a href="../reference/PresenceAbsence.html">?PresenceAbsence</a></code>. To obtain summary information about the
generated Presence-Absence Matrix (PAM), the <code>summary</code>
function can be employed.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">PAM</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Class: PresenceAbsence</span></span>
<span><span class="co">## _ _</span></span>
<span><span class="co">## Number of species: 32 </span></span>
<span><span class="co">## Number of cells: 1187</span></span>
<span><span class="co">## Cells with presence: 1187</span></span>
<span><span class="co">## Cells without presence: 0</span></span>
<span><span class="co">## Species without presence: 0</span></span>
<span><span class="co">## Species with the largest range: Phyllomedusa hypochondrialis</span></span>
<span><span class="co">## _ _</span></span>
<span><span class="co">## Grid parameters</span></span>
<span><span class="co">## Resolution: 1, 1 (x, y)</span></span>
<span><span class="co">## Extention: -93, -29, -57, 15 (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## Coord. Ref.:  +proj=longlat +datum=WGS84 +no_defs</span></span></code></pre>
<p>You can also use the <code>plot</code> function directly to the PAM
object.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">PAM</span><span class="op">)</span></span></code></pre></div>
<p><img src="A-guide-to-transform-species-distributions-into-a-presence-absence-matrix-based_files/figure-html/unnamed-chunk-5-1.png" width="384" style="display: block; margin: auto;"></p>
<p>The <code>plot</code> function also allow users to plot specific
species distributions. For example, we can plot the map of
<em>Phyllomedusa hypochondrialis</em>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">PAM</span>, name <span class="op">=</span> <span class="st">"Phyllomedusa hypochondrialis"</span><span class="op">)</span></span></code></pre></div>
<p><img src="A-guide-to-transform-species-distributions-into-a-presence-absence-matrix-based_files/figure-html/unnamed-chunk-6-1.png" width="384" style="display: block; margin: auto;"></p>
<p>As said before, the PAM object contains the actual presence absence
matrix, to access it we can use the following code:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">presab</span> <span class="op">&lt;-</span> <span class="va">PAM</span><span class="op">$</span><span class="va">Presence_and_Absence_Matrix</span></span></code></pre></div>
<p>The first two columns of the matrix contain the longitude (x) and
latitude (y) of the cells’ centroid, the following columns include the
species’ presence(1) and absence(0) information.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print only the first 5 rows and 3 columns</span></span>
<span><span class="va">presab</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##      Longitude(x) Latitude(y) Phyllomedusa araguari</span></span>
<span><span class="co">## [1,]        -74.5        11.5                     0</span></span>
<span><span class="co">## [2,]        -69.5        11.5                     0</span></span>
<span><span class="co">## [3,]        -68.5        11.5                     0</span></span>
<span><span class="co">## [4,]        -75.5        10.5                     0</span></span>
<span><span class="co">## [5,]        -74.5        10.5                     0</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="using-different-projections">Using different projections<a class="anchor" aria-label="anchor" href="#using-different-projections"></a>
</h3>
<p>Some users may want to use different projections to generate the
presence absence matrix. The <code>lets.presab</code> function allow
users to do it by changing the <code>crs.grid</code> argument. Check the
example using the South America Equidistant Conic projection.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"+proj=eqdc +lat_0=-32 +lon_0=-60 +lat_1=-5"</span>,</span>
<span>             <span class="st">"+lat_2=-42 +x_0=0 +y_0=0 +ellps=aust_SA"</span>, </span>
<span>             <span class="st">"+units=m +no_defs"</span><span class="op">)</span></span>
<span><span class="va">SA_EC</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">pro</span><span class="op">)</span></span>
<span><span class="va">PAM_proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lets.presab.html">lets.presab</a></span><span class="op">(</span><span class="va">Phyllomedusa</span>, xmn <span class="op">=</span> <span class="op">-</span><span class="fl">4135157</span>,</span>
<span>                        xmx <span class="op">=</span> <span class="fl">4707602</span>,</span>
<span>                        ymn <span class="op">=</span> <span class="op">-</span><span class="fl">450000</span>, ymx <span class="op">=</span> <span class="fl">5774733</span>,</span>
<span>                        res <span class="op">=</span> <span class="fl">100000</span>,</span>
<span>                        crs.grid <span class="op">=</span> <span class="va">SA_EC</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">PAM_proj</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Class: PresenceAbsence</span></span>
<span><span class="co">## _ _</span></span>
<span><span class="co">## Number of species: 32 </span></span>
<span><span class="co">## Number of cells: 1396</span></span>
<span><span class="co">## Cells with presence: 1396</span></span>
<span><span class="co">## Cells without presence: 0</span></span>
<span><span class="co">## Species without presence: 0</span></span>
<span><span class="co">## Species with the largest range: Phyllomedusa hypochondrialis</span></span>
<span><span class="co">## _ _</span></span>
<span><span class="co">## Grid parameters</span></span>
<span><span class="co">## Resolution: 1e+05, 1e+05 (x, y)</span></span>
<span><span class="co">## Extention: -4135157, 4664843, -450000, 5750000 (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## Coord. Ref.:  +proj=eqdc +lat_0=-32 +lon_0=-60 +lat_1=-5 +lat_2=-42 +x_0=0 +y_0=0 +ellps=aust_SA +units=m +no_defs</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">PAM_proj</span><span class="op">)</span></span>
<span><span class="co"># Add projected country boundaries</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"wrld_simpl"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">wrld_simpl</span><span class="op">)</span>, <span class="va">pro</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="A-guide-to-transform-species-distributions-into-a-presence-absence-matrix-based_files/figure-html/unnamed-chunk-11-1.png" width="384" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="other-features">Other features<a class="anchor" aria-label="anchor" href="#other-features"></a>
</h3>
<p>The function <code>lets.presab</code> has some other useful
arguments. For instance, users may wish to exclude regions where species
are extinct or retain only the breeding ranges. The
<code>presence</code>, <code>origin</code>, and <code>seasonal</code>
arguments enable users to filter species distributions based on the IUCN
classification of different parts of a species’ range. To find the
specific values for these arguments, consult the <a href="http://www.iucnredlist.org/technical-documents/spatial-data" class="external-link">IUCN
metadata files</a>.</p>
<p>In certain scenarios, it proves advantageous to consider a species
present in a cell only if it covers more than a specified percentage
value. Users can customize this threshold using the <code>cover</code>
argument. It’s important to note that initially, this option is
exclusively available when the coordinates are in degrees
(longitude/latitude). However, with the latest update on <a href="https://github.com/macroecology/letsR" class="external-link">GitHub</a>, users can now
employ the <code>cover</code> argument with other projections as
well.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 90% cover</span></span>
<span><span class="va">PAM_90</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lets.presab.html">lets.presab</a></span><span class="op">(</span><span class="va">Phyllomedusa</span>, xmn <span class="op">=</span> <span class="op">-</span><span class="fl">93</span>,</span>
<span>                      xmx <span class="op">=</span> <span class="op">-</span><span class="fl">29</span>, ymn <span class="op">=</span> <span class="op">-</span><span class="fl">57</span>,</span>
<span>                      ymx <span class="op">=</span> <span class="fl">15</span>, res <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                      cover <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">PAM_90</span><span class="op">)</span></span></code></pre></div>
<p><img src="A-guide-to-transform-species-distributions-into-a-presence-absence-matrix-based_files/figure-html/unnamed-chunk-12-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Observing the plot above, it’s evident that cells near the
continent’s border no longer reflect the presence of the species.</p>
<p>When generating multiple <code>PresenceAbsence</code> objects for
distinct groups, users might prefer to maintain a consistent grid. To
achieve this, it’s crucial to retain the
<code>remove.cells = FALSE</code> argument, preventing any modification
to the grid. Conversely, setting <code>remove.cells = TRUE</code>
excludes cells with a value of zero in the final matrix, meaning sites
where no species are present won’t be included.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PAM_keep_cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lets.presab.html">lets.presab</a></span><span class="op">(</span><span class="va">Phyllomedusa</span>, xmn <span class="op">=</span> <span class="op">-</span><span class="fl">93</span>,</span>
<span>                              xmx <span class="op">=</span> <span class="op">-</span><span class="fl">29</span>, ymn <span class="op">=</span> <span class="op">-</span><span class="fl">57</span>,</span>
<span>                              ymx <span class="op">=</span> <span class="fl">15</span>, res <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                              remove.cells <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>You can now employ the <code>summary</code> function to confirm
whether the empty cells were retained.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">PAM_keep_cells</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Class: PresenceAbsence</span></span>
<span><span class="co">## _ _</span></span>
<span><span class="co">## Number of species: 32 </span></span>
<span><span class="co">## Number of cells: 4608</span></span>
<span><span class="co">## Cells with presence: 1187</span></span>
<span><span class="co">## Cells without presence: 3421</span></span>
<span><span class="co">## Species without presence: 0</span></span>
<span><span class="co">## Species with the largest range: Phyllomedusa hypochondrialis</span></span>
<span><span class="co">## _ _</span></span>
<span><span class="co">## Grid parameters</span></span>
<span><span class="co">## Resolution: 1, 1 (x, y)</span></span>
<span><span class="co">## Extention: -93, -29, -57, 15 (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## Coord. Ref.:  +proj=longlat +datum=WGS84 +no_defs</span></span></code></pre>
<p>Additionally, for users intending to retain species that do not occur
in any cell of the grid, it is essential to configure
<code>remove.sp = FALSE</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="occurrence-data-e-g--gbif">Occurrence data (e.g. GBIF)<a class="anchor" aria-label="anchor" href="#occurrence-data-e-g--gbif"></a>
</h2>
<p>Another prevalent source of spatial data is occurrence records. The
<code>lets.presab.points</code> function enables users to input these
records, generating a <code>PresenceAbsence</code> object. To utilize
this function, you’ll need a two-column matrix containing longitude and
latitude, along with a vector indicating the species name for each
occurrence record. In the example below, we are going to simulate random
occurrence points.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"sp1"</span>, <span class="fl">100</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"sp2"</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"sp3"</span>, <span class="fl">100</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"sp4"</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">400</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">69</span>, max <span class="op">=</span> <span class="op">-</span><span class="fl">51</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">400</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">23</span>, max <span class="op">=</span> <span class="op">-</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p>Now that we have the coordinates and species name, we can use the
<code>lets.presab.points</code> function.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PAM_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lets.presab.points.html">lets.presab.points</a></span><span class="op">(</span><span class="va">xy</span>, <span class="va">species</span>, xmn <span class="op">=</span> <span class="op">-</span><span class="fl">93</span>, xmx <span class="op">=</span> <span class="op">-</span><span class="fl">29</span>,</span>
<span>                          ymn <span class="op">=</span> <span class="op">-</span><span class="fl">57</span>, ymx <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">PAM_points</span><span class="op">)</span></span></code></pre></div>
<p><img src="A-guide-to-transform-species-distributions-into-a-presence-absence-matrix-based_files/figure-html/unnamed-chunk-16-1.png" width="384" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="using-your-own-grid">Using your own grid<a class="anchor" aria-label="anchor" href="#using-your-own-grid"></a>
</h2>
<p>For different reasons some users may want to create a presence
absence matrix based on their own grid in shapefile format. The function
<code>lets.presab.grid</code> allow users to convert species’ ranges
into a presence-absence matrix based on a grid in shapefile format.
However, this function only returns the actual matrix of presence
absence and the grid, not an <code>PresenceAbsence</code> object. In
some situations it is possible to convert this result to a
<code>PresenceAbsence</code> object, I will cover this in a new post
soon. Let’s first create our grid:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Grid </span></span>
<span><span class="va">sp.r</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/as.polygons.html" class="external-link">as.polygons</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="op">-</span><span class="fl">93</span>, xmax <span class="op">=</span> <span class="op">-</span><span class="fl">29</span>,</span>
<span>                                ymin <span class="op">=</span> <span class="op">-</span><span class="fl">57</span>, ymax <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                                resolution <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Give an ID to the cell</span></span>
<span><span class="va">sp.r</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sp.r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sp.r</span>, border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">wrld_simpl</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">T</span>, fill <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="A-guide-to-transform-species-distributions-into-a-presence-absence-matrix-based_files/figure-html/unnamed-chunk-17-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Now we can build our presence absence matrix from the grid.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lets.presab.grid.html">lets.presab.grid</a></span><span class="op">(</span><span class="va">Phyllomedusa</span>, <span class="va">sp.r</span>, <span class="st">"ID"</span><span class="op">)</span></span></code></pre></div>
<p>The result is a list with the presence absence matrix and the grid.
To plot the richness map we can use the following code:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rich_plus1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">resu</span><span class="op">$</span><span class="va">PAM</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="va">colfunc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#fff5f0"</span>, <span class="st">"#fb6a4a"</span>, <span class="st">"#67000d"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="fu">colfunc</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">rich_plus1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">resu</span><span class="op">$</span><span class="va">grid</span>, border <span class="op">=</span> <span class="st">"gray40"</span>,</span>
<span>     col <span class="op">=</span> <span class="va">colors</span><span class="op">[</span><span class="va">rich_plus1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">wrld_simpl</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="A-guide-to-transform-species-distributions-into-a-presence-absence-matrix-based_files/figure-html/unnamed-chunk-19-1.png" width="384" style="display: block; margin: auto;"></p>
<p>This covers all the functions to convert species distribution into
presence absence matrix using the <code>letsR</code> package. Let me
know if you have any suggestion or comments, and please share if you
like it.</p>
<p><strong>To cite letsR in publications use:</strong> <em>Bruno Vilela
and Fabricio Villalobos (2015). letsR: a new R package for data handling
and analysis in macroecology. Methods in Ecology and Evolution. DOI:
10.1111/2041-210X.12401</em></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Bruno Vilela, Fabricio Villalobos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
