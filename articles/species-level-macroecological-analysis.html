<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Macroecological analysis at the species level • letsR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Macroecological analysis at the species level">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">letsR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">5.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/A-guide-to-transform-species-distributions-into-a-presence-absence-matrix-based.html">A guide to transform species distributions into a presence absence matrix based on a user-defined grid in R</a></li>
    <li><a class="dropdown-item" href="../articles/Adding-variables-to-a-presenceabsence-object.html">Adding variables to a PresenceAbsence object</a></li>
    <li><a class="dropdown-item" href="../articles/cropping-and-subseting-your-presence-absence-matrix.html">Cropping and subseting your presence absence matrix</a></li>
    <li><a class="dropdown-item" href="../articles/mapping-species-traits.html">Mapping species traits: community level analysis</a></li>
    <li><a class="dropdown-item" href="../articles/save-load-presenceabsence.html">How to save and load a PresenceAbsence object</a></li>
    <li><a class="dropdown-item" href="../articles/species-level-macroecological-analysis.html">Macroecological analysis at the species level</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/macroecology/letsR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="species-level-macroecological-analysis_files/kePrint-0.0.1/kePrint.js"></script><link href="species-level-macroecological-analysis_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Macroecological analysis at the species level</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/macroecology/letsR/blob/master/vignettes/species-level-macroecological-analysis.Rmd" class="external-link"><code>vignettes/species-level-macroecological-analysis.Rmd</code></a></small>
      <div class="d-none name"><code>species-level-macroecological-analysis.Rmd</code></div>
    </div>

    
    
<p>In another post, I have shown how to use <a href="https://besjournals.onlinelibrary.wiley.com/doi/abs/10.1111/2041-210X.12401" class="external-link"><code>letsR</code></a>
to analyze species traits at the community level. But, in many cases
this type of analysis can lead to spurious patterns (<a href="https://onlinelibrary.wiley.com/doi/full/10.1111/jbi.12953" class="external-link">click
here for further discussion on this issue</a>). An alternative can be
analyzing the data at the species-level. In this post, I will show two
examples on how to make macroecological analysis at the species level
using the <code>letsR</code> package. In the first example, we will
continue the test of Rapoport’s rule on Phyllomedusa frogs using species
centroids. In the second example, we will summarize climate spatial data
at the species level to explore how temperature correlates with
Phyllomedusa species extinction risk.</p>
<p>To start this test we can load our example
<code>PresenceAbsence</code> object.</p>
<p><em>Note: I recommend to use the latest version of the
<code>letsR</code> package on <a href="https://github.com/macroecology/letsR" class="external-link">GitHub</a></em></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.12401" class="external-link">letsR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"PAM"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">PAM</span><span class="op">)</span></span></code></pre></div>
<p><img src="species-level-macroecological-analysis_files/figure-html/r-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="section level2">
<h2 id="example-1-species-level-test-of-rapoports-rule-on-phyllomedusa-frogs-">Example 1: Species level test of Rapoport’s rule on Phyllomedusa
frogs.<a class="anchor" aria-label="anchor" href="#example-1-species-level-test-of-rapoports-rule-on-phyllomedusa-frogs-"></a>
</h2>
<p>We first have to calculate species range size. We can do it directly
on the species shapefiles for higher precision.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Phyllomedusa"</span><span class="op">)</span></span>
<span><span class="va">rangesize</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lets.rangesize.html">lets.rangesize</a></span><span class="op">(</span><span class="va">Phyllomedusa</span>,</span>
<span>                            coordinates <span class="op">=</span> <span class="st">"geographic"</span><span class="op">)</span></span>
<span><span class="va">rangesize</span> <span class="op">&lt;-</span> <span class="va">rangesize</span> <span class="op">/</span> <span class="fl">1000</span> <span class="co"># Transform in km2</span></span></code></pre></div>
<p>The second step is to calculate species geographical
centroid/midpoint using the function <code>lets.midpoint</code>. There
are several ways to calculate species geographic centroid, and this
function offers several methods to do it. When species range are both
circular and continuous, all of the methods will provide the same
answer. However, as the shape of distributions start to become more
complex, different methods will provide very different answers. For this
example, we will use the default option “PC” (polygon centroid). This
method will generate a polygon from the raster, and calculate the
centroid of this polygon.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">centroids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lets.midpoint.html">lets.midpoint</a></span><span class="op">(</span><span class="va">PAM</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">centroids</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:600px; ">
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Species
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
x
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
y
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Phyllomedusa araguari
</td>
<td style="text-align:right;">
-47.50000
</td>
<td style="text-align:right;">
-19.500000
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa atelopoides
</td>
<td style="text-align:right;">
-72.50000
</td>
<td style="text-align:right;">
-7.053571
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa ayeaye
</td>
<td style="text-align:right;">
-46.83333
</td>
<td style="text-align:right;">
-20.833333
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa azurea
</td>
<td style="text-align:right;">
-56.49554
</td>
<td style="text-align:right;">
-19.098214
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa bahiana
</td>
<td style="text-align:right;">
-40.03846
</td>
<td style="text-align:right;">
-11.807692
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa baltea
</td>
<td style="text-align:right;">
-74.50000
</td>
<td style="text-align:right;">
-9.500000
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa bicolor
</td>
<td style="text-align:right;">
-60.87860
</td>
<td style="text-align:right;">
-3.374486
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa boliviana
</td>
<td style="text-align:right;">
-62.11165
</td>
<td style="text-align:right;">
-15.082524
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa burmeisteri
</td>
<td style="text-align:right;">
-43.23684
</td>
<td style="text-align:right;">
-17.912281
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa camba
</td>
<td style="text-align:right;">
-66.03398
</td>
<td style="text-align:right;">
-11.995146
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa centralis
</td>
<td style="text-align:right;">
-55.50000
</td>
<td style="text-align:right;">
-15.500000
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa coelestis
</td>
<td style="text-align:right;">
-76.07143
</td>
<td style="text-align:right;">
-3.857143
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa distincta
</td>
<td style="text-align:right;">
-48.08333
</td>
<td style="text-align:right;">
-25.500000
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa duellmani
</td>
<td style="text-align:right;">
-77.50000
</td>
<td style="text-align:right;">
-5.500000
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa ecuatoriana
</td>
<td style="text-align:right;">
-78.50000
</td>
<td style="text-align:right;">
-2.500000
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa hypochondrialis
</td>
<td style="text-align:right;">
-55.69363
</td>
<td style="text-align:right;">
-9.071974
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa iheringii
</td>
<td style="text-align:right;">
-53.59677
</td>
<td style="text-align:right;">
-31.758064
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa itacolomi
</td>
<td style="text-align:right;">
-43.50000
</td>
<td style="text-align:right;">
-20.500000
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa megacephala
</td>
<td style="text-align:right;">
-43.00000
</td>
<td style="text-align:right;">
-19.500000
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa neildi
</td>
<td style="text-align:right;">
-69.50000
</td>
<td style="text-align:right;">
11.000000
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa nordestina
</td>
<td style="text-align:right;">
-40.66216
</td>
<td style="text-align:right;">
-10.707207
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa oreades
</td>
<td style="text-align:right;">
-48.25000
</td>
<td style="text-align:right;">
-14.750000
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa palliata
</td>
<td style="text-align:right;">
-69.82031
</td>
<td style="text-align:right;">
-9.289062
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa perinesos
</td>
<td style="text-align:right;">
-76.50000
</td>
<td style="text-align:right;">
0.500000
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa rohdei
</td>
<td style="text-align:right;">
-43.83333
</td>
<td style="text-align:right;">
-21.981482
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa sauvagii
</td>
<td style="text-align:right;">
-60.04264
</td>
<td style="text-align:right;">
-24.011628
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa tarsius
</td>
<td style="text-align:right;">
-67.12143
</td>
<td style="text-align:right;">
-4.596429
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa tetraploidea
</td>
<td style="text-align:right;">
-51.79630
</td>
<td style="text-align:right;">
-24.074074
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa tomopterna
</td>
<td style="text-align:right;">
-62.56324
</td>
<td style="text-align:right;">
-4.081028
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa trinitatis
</td>
<td style="text-align:right;">
-65.77778
</td>
<td style="text-align:right;">
10.277778
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa vaillantii
</td>
<td style="text-align:right;">
-61.87419
</td>
<td style="text-align:right;">
-4.947312
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa venusta
</td>
<td style="text-align:right;">
-75.23077
</td>
<td style="text-align:right;">
7.461538
</td>
</tr>
</tbody>
</table>
</div>
<p>We can also plot the geographical centroids.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">centroids</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, </span>
<span>                <span class="st">"Species"</span> <span class="op">=</span> <span class="va">centroids</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, </span>
<span>                <span class="st">"Range size"</span> <span class="op">=</span> <span class="va">rangesize</span><span class="op">)</span></span>
<span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">d</span>, geom  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">wrld_simpl</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="species-level-macroecological-analysis_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
<p>To check the Rapoport’s rule we can plot the latitude against the
range size:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">centroids</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="st">"Range size"</span> <span class="op">=</span> <span class="va">rangesize</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">Range_size</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Latitude(x)"</span>, y <span class="op">=</span> <span class="st">"Range size"</span><span class="op">)</span></span></code></pre></div>
<p><img src="species-level-macroecological-analysis_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Again, the data indicate that Rapoport’s rule does not apply for
Phyllomedusa genus. However, there seems to be an interesting pattern
where range size decreases from the center towards the extremes of the
group. This could be an effect of niche conservatism, where species in
the extreme latitude would face very different conditions from the
ancestral Phylllomedusa. Another possibility is that this pattern could
be due to the shape of the continent, where extreme latitudes means
smaller longitudes.</p>
</div>
<div class="section level2">
<h2 id="example-2-extinction-risk-correlation-with-temperature">Example 2: Extinction risk correlation with temperature<a class="anchor" aria-label="anchor" href="#example-2-extinction-risk-correlation-with-temperature"></a>
</h2>
<p>To evaluate how temperature correlates with extinction risk, we first
have to add the temperature variable to the <code>PresenceAbsence</code>
object.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/wrap.html" class="external-link">unwrap</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span>
<span><span class="va">PAM_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lets.addvar.html">lets.addvar</a></span><span class="op">(</span><span class="va">PAM</span>, <span class="va">r</span>, fun <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in lets.addvar(PAM, r, fun = mean): Reprojecting y to match the</span></span>
<span><span class="co">#&gt; projection in x</span></span></code></pre></div>
<p>Next step is to get the average temperature values per species. The
<code>lets.summarizer</code> can do this directly on the resulting
object of <code>lets.addvar</code> function (note that this can only be
done if <code>onlyvar = FALSE</code>). We only have to indicate the
position of the variable in the matrix using the argument
<code>pos</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">PAM_env</span><span class="op">)</span> <span class="op">==</span> <span class="st">"wc2.1_10m_bio_1_mean"</span><span class="op">)</span></span>
<span><span class="va">temp_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lets.summarizer.html">lets.summarizer</a></span><span class="op">(</span><span class="va">PAM_env</span>, <span class="va">pos</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp_mean</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:400px; ">
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Species
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
wc2.1_10m_bio_1_mean
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Phyllomedusa araguari
</td>
<td style="text-align:right;">
20.56603
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa atelopoides
</td>
<td style="text-align:right;">
25.52649
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa ayeaye
</td>
<td style="text-align:right;">
20.06813
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa azurea
</td>
<td style="text-align:right;">
23.49658
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa bahiana
</td>
<td style="text-align:right;">
23.10110
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa baltea
</td>
<td style="text-align:right;">
25.62387
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa bicolor
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa boliviana
</td>
<td style="text-align:right;">
24.17175
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa burmeisteri
</td>
<td style="text-align:right;">
21.86432
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa camba
</td>
<td style="text-align:right;">
24.93428
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa centralis
</td>
<td style="text-align:right;">
23.34730
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa coelestis
</td>
<td style="text-align:right;">
24.96714
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa distincta
</td>
<td style="text-align:right;">
18.98532
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa duellmani
</td>
<td style="text-align:right;">
21.59888
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa ecuatoriana
</td>
<td style="text-align:right;">
14.30585
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa hypochondrialis
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa iheringii
</td>
<td style="text-align:right;">
18.08854
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa itacolomi
</td>
<td style="text-align:right;">
19.36243
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa megacephala
</td>
<td style="text-align:right;">
20.85050
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa neildi
</td>
<td style="text-align:right;">
25.19995
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa nordestina
</td>
<td style="text-align:right;">
23.96218
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa oreades
</td>
<td style="text-align:right;">
23.07010
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa palliata
</td>
<td style="text-align:right;">
25.15378
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa perinesos
</td>
<td style="text-align:right;">
22.04672
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa rohdei
</td>
<td style="text-align:right;">
20.62165
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa sauvagii
</td>
<td style="text-align:right;">
22.33336
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa tarsius
</td>
<td style="text-align:right;">
25.48131
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa tetraploidea
</td>
<td style="text-align:right;">
20.37571
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa tomopterna
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa trinitatis
</td>
<td style="text-align:right;">
25.59346
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa vaillantii
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa venusta
</td>
<td style="text-align:right;">
24.33024
</td>
</tr>
</tbody>
</table>
</div>
<p>Following our example, we need to obtain the IUCN extinction risk
data. Previous version of the package included functions to do this, but
they are no longer supported. Luckily, there is a new package called <a href="https://docs.ropensci.org/rredlist/" class="external-link"><code>rredlist</code></a>
that can do this for us. Yet, for now, we can use the example data in
the <code>letsR</code> package called <code>IUCN</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"IUCN"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IUCN</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:800px; ">
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Species
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Family
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Status
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Criteria
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Population
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Description_Year
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Country
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Phyllomedusa araguari
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
DD
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
2007
</td>
<td style="text-align:left;">
Brazil
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa atelopoides
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
1988
</td>
<td style="text-align:left;">
Bolivia, Brazil, Peru
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa ayeaye
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
CR
</td>
<td style="text-align:left;">
B1ab(iii)+2ab(iii)
</td>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
1966
</td>
<td style="text-align:left;">
Brazil
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa azurea
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
DD
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
1862
</td>
<td style="text-align:left;">
Argentina, Bolivia, Brazil, Paraguay
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa bahiana
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
DD
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
1925
</td>
<td style="text-align:left;">
Brazil
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa baltea
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
EN
</td>
<td style="text-align:left;">
B1ab(iii)+2ab(iii)
</td>
<td style="text-align:left;">
Decreasing
</td>
<td style="text-align:right;">
1979
</td>
<td style="text-align:left;">
Peru
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa bicolor
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Stable
</td>
<td style="text-align:right;">
1772
</td>
<td style="text-align:left;">
Bolivia, Brazil, Colombia, French Guiana, Guyana, Peru, Suriname,
Venezuela
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa boliviana
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Stable
</td>
<td style="text-align:right;">
1902
</td>
<td style="text-align:left;">
Argentina, Bolivia, Brazil
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa burmeisteri
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Stable
</td>
<td style="text-align:right;">
1882
</td>
<td style="text-align:left;">
Brazil
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa camba
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Stable
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:left;">
Bolivia, Brazil, Peru
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa centralis
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
DD
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
1965
</td>
<td style="text-align:left;">
Brazil
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa coelestis
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
1874
</td>
<td style="text-align:left;">
Colombia, Ecuador, Peru
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa distincta
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Decreasing
</td>
<td style="text-align:right;">
1950
</td>
<td style="text-align:left;">
Brazil
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa duellmani
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
DD
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
1982
</td>
<td style="text-align:left;">
Peru
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa ecuatoriana
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
EN
</td>
<td style="text-align:left;">
B1ab(iii)
</td>
<td style="text-align:left;">
Decreasing
</td>
<td style="text-align:right;">
1982
</td>
<td style="text-align:left;">
Ecuador
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa hypochondrialis
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Stable
</td>
<td style="text-align:right;">
1800
</td>
<td style="text-align:left;">
Argentina, Bolivia, Brazil, Colombia, French Guiana, Guyana, Paraguay,
Suriname, Venezuela
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa iheringii
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
1885
</td>
<td style="text-align:left;">
Brazil, Uruguay
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa itacolomi
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
DD
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
2006
</td>
<td style="text-align:left;">
Brazil
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa megacephala
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
DD
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
1926
</td>
<td style="text-align:left;">
Brazil
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa neildi
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
DD
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
2006
</td>
<td style="text-align:left;">
Venezuela
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa nordestina
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
DD
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
2006
</td>
<td style="text-align:left;">
Brazil
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa oreades
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
DD
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
2002
</td>
<td style="text-align:left;">
Brazil
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa palliata
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Stable
</td>
<td style="text-align:right;">
1873
</td>
<td style="text-align:left;">
Bolivia, Brazil, Ecuador, Peru
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa perinesos
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
DD
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
1973
</td>
<td style="text-align:left;">
Colombia, Ecuador
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa rohdei
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Stable
</td>
<td style="text-align:right;">
1926
</td>
<td style="text-align:left;">
Brazil
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa sauvagii
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Stable
</td>
<td style="text-align:right;">
1882
</td>
<td style="text-align:left;">
Argentina, Bolivia, Brazil, Paraguay
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa tarsius
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Stable
</td>
<td style="text-align:right;">
1868
</td>
<td style="text-align:left;">
Brazil, Colombia, Ecuador, Peru, Venezuela
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa tetraploidea
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Stable
</td>
<td style="text-align:right;">
1992
</td>
<td style="text-align:left;">
Argentina, Brazil, Paraguay
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa tomopterna
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Stable
</td>
<td style="text-align:right;">
1868
</td>
<td style="text-align:left;">
Bolivia, Brazil, Colombia, Ecuador, French Guiana, Guyana, Peru,
Suriname, Venezuela
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa trinitatis
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Stable
</td>
<td style="text-align:right;">
1926
</td>
<td style="text-align:left;">
Trinidad and Tobago, Venezuela
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa vaillantii
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Stable
</td>
<td style="text-align:right;">
1882
</td>
<td style="text-align:left;">
Bolivia, Brazil, Colombia, Ecuador, French Guiana, Guyana, Peru,
Suriname, Venezuela
</td>
</tr>
<tr>
<td style="text-align:left;">
Phyllomedusa venusta
</td>
<td style="text-align:left;">
HYLIDAE
</td>
<td style="text-align:left;">
LC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Decreasing
</td>
<td style="text-align:right;">
1967
</td>
<td style="text-align:left;">
Colombia, Panama
</td>
</tr>
</tbody>
</table>
</div>
<p>Finally, we can verify the relationship between temperature and
extinction risk.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">level_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DD"</span>, <span class="st">"LC"</span>,  <span class="st">"EN"</span>, <span class="st">"CR"</span><span class="op">)</span> <span class="co"># ordering for the plot</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Status"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">IUCN</span><span class="op">$</span><span class="va">Status</span>, levels <span class="op">=</span> <span class="va">level_order</span><span class="op">)</span>,</span>
<span>                   <span class="st">"Temperature"</span> <span class="op">=</span> <span class="va">temp_mean</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Status</span>, <span class="va">Temperature</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_boxplot()`).</span></span></code></pre></div>
<p><img src="species-level-macroecological-analysis_files/figure-html/unnamed-chunk-17-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The graph indicate that there is a tendency for threatened
Phyllomedusa species to occur in colder regions. Still, further
statistical analysis should be done to confirm this pattern.</p>
<p><strong>To cite letsR in publications use:</strong> <em>Bruno Vilela
and Fabricio Villalobos (2015). letsR: a new R package for data handling
and analysis in macroecology. Methods in Ecology and Evolution. DOI:
10.1111/2041-210X.12401</em></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bruno Vilela, Fabricio Villalobos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
